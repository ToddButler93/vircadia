"use strict";(globalThis["webpackChunkvircadia_domain_dashboard"]=globalThis["webpackChunkvircadia_domain_dashboard"]||[]).push([[714],{5593:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(7483),a=n(8563),i=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(t){i(t)}}function l(e){try{u(o["throw"](e))}catch(t){i(t)}}function u(e){e.done?n(e.value):a(e.value).then(s,l)}u((o=o.apply(e,t||[])).next())}))};const s=n(52),l=[],u={getValues(){return i(this,void 0,void 0,(function*(){let e={};try{const t="settings.json",n=yield(0,o.YW)(t);return e=n.values,e}catch(t){const e=(0,o.GD)(t);console.log(e)}return e}))},getDescriptions(){return i(this,void 0,void 0,(function*(){let e=[];try{const t="settings.json",n=yield(0,o.YW)(t);return e=n.descriptions,e}catch(t){const e=(0,o.GD)(t);console.log(e)}return e}))},commitSettings(e){return s.post("/settings.json",JSON.stringify(e)).then((()=>(a.Z.info(a.Z.types.DOMAIN,"Successfully committed settings."),!0))).catch((e=>(a.Z.error(a.Z.types.DOMAIN,`Failed to commit settings to Domain: ${e}`),!1)))},automaticCommitSettings(e){l.forEach(((e,t)=>{clearTimeout(e),l.splice(t,1)})),l.push(window.setTimeout(this.commitSettings,5e3,e))},createNewDomainID(e){return i(this,void 0,void 0,(function*(){try{const t=`label=${e}`,n=yield s.post("/api/domains",t);if("failure"===n.data.status)return"";const o=n.data.domain.domainId;return o}catch(t){return console.log(t),""}}))},getDomains(){return i(this,void 0,void 0,(function*(){let e=[];try{const t="api/domains",n=yield(0,o.YW)(t);return e=n.data.domains,e}catch(t){console.log(t)}return e}))}}},7483:(e,t,n)=>{n.d(t,{ge:()=>c,YW:()=>r,GD:()=>l});var o=n(52),a=n.n(o);const i="http://localhost:40100/";var s=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(t){i(t)}}function l(e){try{u(o["throw"](e))}catch(t){i(t)}}function u(e){e.done?n(e.value):a(e.value).then(s,l)}u((o=o.apply(e,t||[])).next())}))};function l(e){if("string"===typeof e)return e;const t=e;return"message"in t?t.message:`Error: ${JSON.stringify(e)}`}function u(e,t){return(null!==t&&void 0!==t?t:i)+e}function r(e,t){var n;return s(this,void 0,void 0,(function*(){const o=u(e,t);let i="";try{const t=yield a().get(o);if(t&&t.status){if(200===t.status)return t.data;i=`${null!==(n=t.statusText)&&void 0!==n?n:"unspecified"}`}else i=`Poorly formed response to GET ${e}: ${JSON.stringify(t)}`}catch(s){const t=l(s);i=`Exception on GET ${e}: ${t}`,console.log(i)}throw new Error(i)}))}function c(e,t){var n;return s(this,void 0,void 0,(function*(){const o=u(e,t);let i="";try{const t=yield a()["delete"](o);if(t&&t.status){if(200===t.status)return;i=`${null!==(n=t.statusText)&&void 0!==n?n:"unspecified"}`}else i=`Poorly formed response to DELETE ${e}: ${JSON.stringify(t)}`}catch(s){const t=l(s);i=`Exception on DELETE ${e}: ${t}`,console.log(i)}throw new Error(i)}))}},4714:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var o=n(3673);const a={class:"q-pa-md"};function i(e,t,n,i,s,l){const u=(0,o.up)("BackupRestoreSettings"),r=(0,o.up)("AutomaticContentArchivesSettings");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(u),(0,o.Wm)(r)])}var s=n(2323);const l={class:"q-mt-md"},u=(0,o._)("div",{class:"text-h5 text-center text-weight-bold q-mb-sm"},"Automatic Content Archives",-1),r=(0,o._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Rolling Backup Rules",-1),c=(0,o._)("div",{class:"q-mt-xs text-caption text-grey-5"},"Define how frequently to create automatic content archives.",-1),d={class:"text-h6 text-bold text-white full-width"},m={class:"text-warning"},p=(0,o._)("p",{class:"text-body2"},"WARNING: This cannot be undone.",-1);function f(e,t,n,a,i,f){const h=(0,o.up)("q-separator"),g=(0,o.up)("q-th"),w=(0,o.up)("q-tr"),v=(0,o.up)("q-td"),b=(0,o.up)("q-btn"),x=(0,o.up)("q-input"),y=(0,o.up)("q-icon"),_=(0,o.up)("q-table"),k=(0,o.up)("q-card-section"),D=(0,o.up)("q-card"),W=(0,o.up)("q-avatar"),R=(0,o.up)("q-card-actions"),S=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(D,{class:"my-card"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[u,(0,o.Wm)(h),(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[r,c,(0,o.Wm)(_,{dark:"",class:"bg-grey-9",rows:e.rows},{header:(0,o.w5)((()=>[(0,o.Wm)(w,{class:"bg-primary"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"text-left"},{default:(0,o.w5)((()=>[(0,o.Uk)("Name")])),_:1}),(0,o.Wm)(g,{class:"text-left"},{default:(0,o.w5)((()=>[(0,o.Uk)("Backup Interval in Seconds")])),_:1}),(0,o.Wm)(g,{class:"text-left"},{default:(0,o.w5)((()=>[(0,o.Uk)("Max Rolled Backup Versions")])),_:1}),(0,o.Wm)(g,{"auto-width":""})])),_:1})])),body:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.backupRules,((t,n)=>((0,o.wg)(),(0,o.j4)(w,{key:t.Name},{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t.Name),1)])),_:2},1024),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t.backupInterval),1)])),_:2},1024),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(t.maxBackupVersions),1)])),_:2},1024),(0,o.Wm)(v,{class:"text-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{size:"sm",color:"negative",icon:"delete",class:"q-px-xs",onClick:o=>e.onShowConfirmDeleteDialogue("backupRules",n,t.Name),round:""},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),"bottom-row":(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x,{modelValue:e.newRowNames.backupRules.Name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newRowNames.backupRules.Name=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"New Backup Rule Name",dense:""},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x,{modelValue:e.newRowNames.backupRules.backupInterval,"onUpdate:modelValue":t[1]||(t[1]=t=>e.newRowNames.backupRules.backupInterval=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Backup Interval (seconds)",dense:""},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x,{modelValue:e.newRowNames.backupRules.maxBackupVersions,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newRowNames.backupRules.maxBackupVersions=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Maximum Rolled Backup Versions",dense:""},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,{class:"text-center"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{onClick:t[3]||(t[3]=t=>e.onAddRow("backupRules")),color:"positive"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"add",size:"sm"})])),_:1})])),_:1})])),_:1})])),_:1},8,["rows"])])),_:1})])),_:1}),(0,o.Wm)(S,{modelValue:e.confirmDeleteDialogue.show,"onUpdate:modelValue":t[6]||(t[6]=t=>e.confirmDeleteDialogue.show=t),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{class:"bg-primary q-pa-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"row items-center"},{default:(0,o.w5)((()=>[(0,o._)("p",d,[(0,o.Wm)(W,{icon:"mdi-alert",class:"q-mr-sm","text-color":"warning",size:"20px","font-size":"20px"}),(0,o.Uk)("Delete "),(0,o._)("span",m,(0,s.zw)(e.confirmDeleteDialogue.thingToDelete),1),(0,o.Uk)("?")]),p])),_:1}),(0,o.Wm)(R,{align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{flat:"",label:"Cancel",onClick:t[4]||(t[4]=t=>e.onHideConfirmDeleteDialogue())}),(0,o.Wm)(b,{flat:"",label:"Delete",onClick:t[5]||(t[5]=t=>e.onDeleteRow(e.confirmDeleteDialogue.permissionType,e.confirmDeleteDialogue.index))})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])}var h=n(5593),g=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(t){i(t)}}function l(e){try{u(o["throw"](e))}catch(t){i(t)}}function u(e){e.done?n(e.value):a(e.value).then(s,l)}u((o=o.apply(e,t||[])).next())}))};const w=(0,o.aZ)({name:"AutomaticContentArchivesSettings",data(){return{rows:[{}],values:{},newRowNames:{backupRules:{Name:"",backupInterval:0,maxBackupVersions:0}},confirmDeleteDialogue:{show:!1,thingToDelete:"",index:-1,permissionType:""}}},methods:{onShowConfirmDeleteDialogue(e,t,n){this.confirmDeleteDialogue={show:!0,thingToDelete:n,index:t,permissionType:e}},onHideConfirmDeleteDialogue(){this.confirmDeleteDialogue={show:!1,thingToDelete:"",index:-1,permissionType:""}},onDeleteRow(e,t){this.onHideConfirmDeleteDialogue();const n=[...this[e]];n.splice(t,1),this[e]=n},onAddRow(e){this[e]=[...this[e],this.newRowNames[e]],this.newRowNames[e]={Name:"",backupInterval:0,maxBackupVersions:0}},refreshSettingsValues(){return g(this,void 0,void 0,(function*(){this.values=yield h.Z.getValues()}))},saveSettings(){const e={automatic_content_archives:{backup_rules:this.backupRules}};h.Z.automaticCommitSettings(e)}},computed:{backupRules:{get(){var e,t;return null!==(t=null===(e=this.values.automatic_content_archives)||void 0===e?void 0:e.backup_rules)&&void 0!==t?t:[]},set(e){var t;"undefined"!==typeof(null===(t=this.values.automatic_content_archives)||void 0===t?void 0:t.backup_rules)&&(this.values.automatic_content_archives.backup_rules=e,this.saveSettings())}}},beforeMount(){this.refreshSettingsValues()}});var v=n(4260),b=n(151),x=n(5589),y=n(5869),_=n(3350),k=n(8186),D=n(2414),W=n(3884),R=n(8240),S=n(4842),q=n(4554),Z=n(6778),C=n(5096),N=n(9367),V=n(7518),T=n.n(V);const U=(0,v.Z)(w,[["render",f]]),Q=U;T()(w,"components",{QCard:b.Z,QCardSection:x.Z,QSeparator:y.Z,QTable:_.Z,QTr:k.Z,QTh:D.Z,QTd:W.Z,QBtn:R.Z,QInput:S.Z,QIcon:q.Z,QDialog:Z.Z,QAvatar:C.Z,QCardActions:N.Z});const B=(0,o._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Upload a settings configuration to quickly configure this domain",-1),I=(0,o._)("div",{class:"text-caption text-warning"},"Note: Your domain settings will be replaced by the settings you upload.",-1),z={style:{display:"flex","justify-content":"center","align-items":"center"}},A=(0,o._)("h5",{class:"text-grey-1 text-weight-bolder",style:{position:"absolute","z-index":"1"}},"Upload a Settings Configuration",-1),E={class:"text-grey-1 text-weight-bold",style:{position:"absolute","z-index":"1","margin-top":"5rem"}},$={class:"q-mt-md"},j=(0,o._)("p",{class:"q-mb-none text-body1 text-weight-bold"},"Save Your Settings Configuration",-1),Y=(0,o._)("div",{class:"text-caption text-grey-5"},"Download this domain's current settings to quickly configure another domain or to restore them later.",-1);function G(e,t,n,a,i,s){const l=(0,o.up)("q-icon"),u=(0,o.up)("q-uploader"),r=(0,o.up)("q-btn"),c=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(c,{class:"my-card q-pa-md"},{default:(0,o.w5)((()=>[B,I,(0,o._)("div",z,[(0,o.Wm)(l,{style:{position:"absolute","z-index":"1",color:"#555","font-size":"12rem","margin-top":"2rem"},size:"xl",name:"file_upload"}),A,(0,o._)("p",E,[(0,o.Uk)("Drag and Drop Here or Click "),(0,o.Wm)(l,{name:"add_box",size:"xs",class:"q-mb-xs"}),(0,o.Uk)(" to Select a File")]),(0,o.Wm)(u,{label:"Upload a Settings Configuration","max-files":"1",url:"http://localhost:40100/settings/restore",style:{height:"500px","min-width":"100%","background-image":"linear-gradient(-45deg, #3d3d3d 25%, #333 25%, #333 50%, #3d3d3d 50%, #3d3d3d 75%, #333 75%, #333 100%)","background-size":"100px 100px",border:"dashed 1px lightgrey"}})]),(0,o._)("div",$,[j,Y,(0,o.Wm)(r,{color:"positive",href:"/settings/backup.json",target:"_blank",class:"q-mt-sm"},{default:(0,o.w5)((()=>[(0,o.Uk)("Download Domain Settings")])),_:1})])])),_:1})}var M=function(e,t,n,o){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(t){i(t)}}function l(e){try{u(o["throw"](e))}catch(t){i(t)}}function u(e){e.done?n(e.value):a(e.value).then(s,l)}u((o=o.apply(e,t||[])).next())}))};const O=(0,o.aZ)({name:"BackupRestoreSettings",data(){return{values:{},uploadedSettingsConfiguration:null}},methods:{refreshSettingsValues(){return M(this,void 0,void 0,(function*(){this.values=yield h.Z.getValues()}))},saveSettings(){const e={automatic_content_archives:{backup_rules:this.backupRules}};h.Z.automaticCommitSettings(e)}},computed:{backupRules:{get(){var e,t;return null!==(t=null===(e=this.values.automatic_content_archives)||void 0===e?void 0:e.backup_rules)&&void 0!==t?t:[]},set(e){var t;"undefined"!==typeof(null===(t=this.values.automatic_content_archives)||void 0===t?void 0:t.backup_rules)&&(this.values.automatic_content_archives.backup_rules=e,this.saveSettings())}}},beforeMount(){this.refreshSettingsValues()}});var P=n(1745);const H=(0,v.Z)(O,[["render",G]]),J=H;T()(O,"components",{QCard:b.Z,QIcon:q.Z,QUploader:P.Z,QBtn:R.Z});const F=(0,o.aZ)({name:"Index",components:{AutomaticContentArchivesSettings:Q,BackupRestoreSettings:J}}),L=(0,v.Z)(F,[["render",i]]),K=L}}]);