"use strict";(globalThis["webpackChunkvircadia_domain_dashboard"]=globalThis["webpackChunkvircadia_domain_dashboard"]||[]).push([[309],{6309:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var l=a(3673);const o={class:"q-pa-sm row"};function s(e,t,a,s,n,i){const u=(0,l.up)("BackupRestoreSettings"),d=(0,l.up)("AutomaticContentArchivesSettings");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(u,{class:"col-12 col-md"}),(0,l.Wm)(d,{class:"col-12 col-md"})])}var n=a(2323);const i={class:"q-ma-sm"},u=(0,l._)("div",{class:"text-h5 text-center text-weight-bold q-mb-sm"},"Automatic Content Archives",-1),d=(0,l._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Rolling Backup Rules",-1),c=(0,l._)("div",{class:"q-mt-xs text-caption text-grey-5"},"Define how frequently to create automatic content archives.",-1),r={class:"text-h6 text-bold text-white full-width"},m={class:"text-warning"},p=(0,l._)("p",{class:"text-body2"},"WARNING: This cannot be undone.",-1);function w(e,t,a,o,s,w){const g=(0,l.up)("q-separator"),h=(0,l.up)("q-th"),f=(0,l.up)("q-tr"),b=(0,l.up)("q-td"),x=(0,l.up)("q-btn"),_=(0,l.up)("q-input"),k=(0,l.up)("q-icon"),v=(0,l.up)("q-table"),D=(0,l.up)("q-card-section"),W=(0,l.up)("q-card"),y=(0,l.up)("q-avatar"),q=(0,l.up)("q-card-actions"),U=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(W,{class:"my-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[u,(0,l.Wm)(g),(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[d,c,(0,l.Wm)(v,{dark:"",class:"bg-grey-9",rows:e.rows},{header:(0,l.w5)((()=>[(0,l.Wm)(f,{class:"bg-primary"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{class:"text-left"},{default:(0,l.w5)((()=>[(0,l.Uk)("Name")])),_:1}),(0,l.Wm)(h,{class:"text-left"},{default:(0,l.w5)((()=>[(0,l.Uk)("Backup Interval in Seconds")])),_:1}),(0,l.Wm)(h,{class:"text-left"},{default:(0,l.w5)((()=>[(0,l.Uk)("Max Rolled Backup Versions")])),_:1}),(0,l.Wm)(h,{"auto-width":""})])),_:1})])),body:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.backupRules,((t,a)=>((0,l.wg)(),(0,l.j4)(f,{key:t.Name},{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.Name),1)])),_:2},1024),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.backupInterval),1)])),_:2},1024),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.maxBackupVersions),1)])),_:2},1024),(0,l.Wm)(b,{class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{size:"sm",color:"negative",icon:"delete",class:"q-px-xs",onClick:l=>e.onShowConfirmDeleteDialogue("backupRules",a,t.Name),round:""},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),"bottom-row":(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:e.newRowNames.backupRules.Name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newRowNames.backupRules.Name=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"New Backup Rule Name",dense:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:e.newRowNames.backupRules.backupInterval,"onUpdate:modelValue":t[1]||(t[1]=t=>e.newRowNames.backupRules.backupInterval=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Backup Interval (seconds)",dense:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:e.newRowNames.backupRules.maxBackupVersions,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newRowNames.backupRules.maxBackupVersions=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Maximum Rolled Backup Versions",dense:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(b,{class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{onClick:t[3]||(t[3]=t=>e.onAddRow("backupRules")),color:"positive"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"add",size:"sm"})])),_:1})])),_:1})])),_:1})])),_:1},8,["rows"])])),_:1})])),_:1}),(0,l.Wm)(U,{modelValue:e.confirmDeleteDialogue.show,"onUpdate:modelValue":t[6]||(t[6]=t=>e.confirmDeleteDialogue.show=t),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"bg-primary q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{class:"row items-center"},{default:(0,l.w5)((()=>[(0,l._)("p",r,[(0,l.Wm)(y,{icon:"mdi-alert",class:"q-mr-sm","text-color":"warning",size:"20px","font-size":"20px"}),(0,l.Uk)("Delete "),(0,l._)("span",m,(0,n.zw)(e.confirmDeleteDialogue.thingToDelete),1),(0,l.Uk)("?")]),p])),_:1}),(0,l.Wm)(q,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{flat:"",label:"Cancel",onClick:t[4]||(t[4]=t=>e.onHideConfirmDeleteDialogue())}),(0,l.Wm)(x,{flat:"",label:"Delete",onClick:t[5]||(t[5]=t=>e.onDeleteRow(e.confirmDeleteDialogue.permissionType,e.confirmDeleteDialogue.index))})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])}var g=a(5593),h=function(e,t,a,l){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function n(e){try{u(l.next(e))}catch(t){s(t)}}function i(e){try{u(l["throw"](e))}catch(t){s(t)}}function u(e){e.done?a(e.value):o(e.value).then(n,i)}u((l=l.apply(e,t||[])).next())}))};const f=(0,l.aZ)({name:"AutomaticContentArchivesSettings",data(){return{rows:[{}],values:{},newRowNames:{backupRules:{Name:"",backupInterval:0,maxBackupVersions:0}},confirmDeleteDialogue:{show:!1,thingToDelete:"",index:-1,permissionType:""}}},methods:{onShowConfirmDeleteDialogue(e,t,a){this.confirmDeleteDialogue={show:!0,thingToDelete:a,index:t,permissionType:e}},onHideConfirmDeleteDialogue(){this.confirmDeleteDialogue={show:!1,thingToDelete:"",index:-1,permissionType:""}},onDeleteRow(e,t){this.onHideConfirmDeleteDialogue();const a=[...this[e]];a.splice(t,1),this[e]=a},onAddRow(e){this[e]=[...this[e],this.newRowNames[e]],this.newRowNames[e]={Name:"",backupInterval:0,maxBackupVersions:0}},refreshSettingsValues(){return h(this,void 0,void 0,(function*(){this.values=yield g.Z.getValues()}))},saveSettings(){const e={automatic_content_archives:{backup_rules:this.backupRules}};g.Z.automaticCommitSettings(e)}},computed:{backupRules:{get(){var e,t;return null!==(t=null===(e=this.values.automatic_content_archives)||void 0===e?void 0:e.backup_rules)&&void 0!==t?t:[]},set(e){var t;"undefined"!==typeof(null===(t=this.values.automatic_content_archives)||void 0===t?void 0:t.backup_rules)&&(this.values.automatic_content_archives.backup_rules=e,this.saveSettings())}}},beforeMount(){this.refreshSettingsValues()}});var b=a(4260),x=a(151),_=a(5589),k=a(5869),v=a(3350),D=a(8186),W=a(2414),y=a(3884),q=a(8240),U=a(4842),R=a(4554),S=a(6778),C=a(5096),V=a(9367),Z=a(7518),N=a.n(Z);const Q=(0,b.Z)(f,[["render",w]]),T=Q;N()(f,"components",{QCard:x.Z,QCardSection:_.Z,QSeparator:k.Z,QTable:v.Z,QTr:D.Z,QTh:W.Z,QTd:y.Z,QBtn:q.Z,QInput:U.Z,QIcon:R.Z,QDialog:S.Z,QAvatar:C.Z,QCardActions:V.Z});const z=(0,l._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Upload a settings configuration to quickly configure this domain",-1),B=(0,l._)("div",{class:"text-caption text-warning"},"Note: Your domain settings will be replaced by the settings you upload.",-1),A={style:{display:"flex","justify-content":"center","align-items":"center"}},I=(0,l._)("h5",{class:"text-grey-1 text-weight-bolder",style:{position:"absolute","z-index":"1"}},"Upload a Settings Configuration",-1),F={class:"text-grey-1 text-weight-bold",style:{position:"absolute","z-index":"1","margin-top":"5rem"}},P={class:"q-mt-md"},H=(0,l._)("p",{class:"q-mb-none text-body1 text-weight-bold"},"Save Your Settings Configuration",-1),j=(0,l._)("div",{class:"text-caption text-grey-5"},"Download this domain's current settings to quickly configure another domain or to restore them later.",-1),Y=(0,l._)("span",{class:"text-h5 q-mb-sm text-bold text-white"},"Upload Successful!",-1),M={class:"text-body2"},G={class:"text-bold"},K=(0,l._)("span",{class:"text-h5 q-mb-sm text-bold text-white"},"Upload Failed",-1),E=(0,l._)("span",{class:"text-body2"},"Please try again or upload a different settings configuration file.",-1);function J(e,t,a,o,s,i){const u=(0,l.up)("q-icon"),d=(0,l.up)("q-uploader"),c=(0,l.up)("q-btn"),r=(0,l.up)("q-card-section"),m=(0,l.up)("q-card"),p=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)(m,{class:"my-card q-pa-md q-ma-sm"},{default:(0,l.w5)((()=>[z,B,(0,l._)("div",A,[(0,l.Wm)(u,{style:{position:"absolute","z-index":"1",color:"#555","font-size":"12rem","margin-top":"2rem"},size:"xl",name:"file_upload"}),I,(0,l._)("p",F,[(0,l.Uk)("Drag and Drop Here or Click "),(0,l.Wm)(u,{name:"add_box",size:"xs",class:"q-mb-xs"}),(0,l.Uk)("to Select a File")]),(0,l.Wm)(d,{label:"Upload a Settings Configuration","max-files":"1",url:"/settings/restore",onUploaded:e.successfulUpload,onFailed:e.failedUpload,style:{height:"500px","min-width":"100%","background-image":"linear-gradient(-45deg, #3d3d3d 25%, #333 25%, #333 50%, #3d3d3d 50%, #3d3d3d 75%, #333 75%, #333 100%)","background-size":"100px 100px",border:"dashed 1px lightgrey"}},null,8,["onUploaded","onFailed"])]),(0,l._)("div",P,[H,j,(0,l.Wm)(c,{color:"positive",href:"/settings/backup.json",target:"_blank",class:"q-mt-sm"},{default:(0,l.w5)((()=>[(0,l.Uk)("Download Domain Settings")])),_:1})]),(0,l.Wm)(p,{modelValue:e.showSuccessfulUploadDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSuccessfulUploadDialog=t),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"bg-positive q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"row items-center"},{default:(0,l.w5)((()=>[Y,(0,l._)("span",M,[(0,l.Uk)("Your settings will be commmited and the page will refresh in "),(0,l._)("span",G,(0,n.zw)(e.reloadPageTimer),1),(0,l.Uk)(" seconds")])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(p,{modelValue:e.showFailedUploadDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showFailedUploadDialog=t),"auto-close":""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"bg-negative q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{class:"row items-center"},{default:(0,l.w5)((()=>[K,E])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const L=(0,l.aZ)({name:"BackupRestoreSettings",data(){return{uploadedSettingsConfiguration:null,showSuccessfulUploadDialog:!1,reloadPageTimer:3,showFailedUploadDialog:!1}},methods:{successfulUpload(){this.showSuccessfulUploadDialog=!0,window.setInterval((()=>{this.reloadPageTimer--,0===this.reloadPageTimer&&window.location.reload()}),1e3)},failedUpload(){console.log("Failed to upload settings configuration"),this.showFailedUploadDialog=!0}}});var O=a(1745);const X=(0,b.Z)(L,[["render",J]]),$=X;N()(L,"components",{QCard:x.Z,QIcon:R.Z,QUploader:O.Z,QBtn:q.Z,QDialog:S.Z,QCardSection:_.Z});const ee=(0,l.aZ)({name:"Index",components:{AutomaticContentArchivesSettings:T,BackupRestoreSettings:$}}),te=(0,b.Z)(ee,[["render",s]]),ae=te}}]);