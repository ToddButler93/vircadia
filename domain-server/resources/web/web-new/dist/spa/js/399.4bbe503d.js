"use strict";(globalThis["webpackChunkvircadia_domain_dashboard"]=globalThis["webpackChunkvircadia_domain_dashboard"]||[]).push([[399],{5593:(e,t,o)=>{o.d(t,{Z:()=>u});var n=o(7483),a=o(8563),s=function(e,t,o,n){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(t){s(t)}}function l(e){try{u(n["throw"](e))}catch(t){s(t)}}function u(e){e.done?o(e.value):a(e.value).then(i,l)}u((n=n.apply(e,t||[])).next())}))};const i=o(52),l=[],u={getValues(){return s(this,void 0,void 0,(function*(){let e={};try{const t="settings.json",o=yield(0,n.YW)(t);return e=o.values,e}catch(t){const e=(0,n.GD)(t);console.log(e)}return e}))},getDescriptions(){return s(this,void 0,void 0,(function*(){let e=[];try{const t="settings.json",o=yield(0,n.YW)(t);return e=o.descriptions,e}catch(t){const e=(0,n.GD)(t);console.log(e)}return e}))},commitSettings(e){return i.post("/settings.json",JSON.stringify(e)).then((()=>(a.Z.info(a.Z.types.DOMAIN,"Successfully committed settings."),!0))).catch((e=>(a.Z.error(a.Z.types.DOMAIN,`Failed to commit settings to Domain: ${e}`),!1)))},automaticCommitSettings(e){l.forEach(((e,t)=>{clearTimeout(e),l.splice(t,1)})),l.push(window.setTimeout(this.commitSettings,5e3,e))},createNewDomainID(e){return s(this,void 0,void 0,(function*(){try{const t=`label=${e}`,o=yield i.post("/api/domains",t);if("failure"===o.data.status)return"";const n=o.data.domain.domainId;return n}catch(t){return console.log(t),""}}))},getDomains(){return s(this,void 0,void 0,(function*(){let e=[];try{const t="api/domains",o=yield(0,n.YW)(t);return e=o.data.domains,e}catch(t){console.log(t)}return e}))}}},7483:(e,t,o)=>{o.d(t,{ge:()=>c,YW:()=>r,GD:()=>l});var n=o(52),a=o.n(n);const s="http://localhost:40100/";var i=function(e,t,o,n){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(t){s(t)}}function l(e){try{u(n["throw"](e))}catch(t){s(t)}}function u(e){e.done?o(e.value):a(e.value).then(i,l)}u((n=n.apply(e,t||[])).next())}))};function l(e){if("string"===typeof e)return e;const t=e;return"message"in t?t.message:`Error: ${JSON.stringify(e)}`}function u(e,t){return(null!==t&&void 0!==t?t:s)+e}function r(e,t){var o;return i(this,void 0,void 0,(function*(){const n=u(e,t);let s="";try{const t=yield a().get(n);if(t&&t.status){if(200===t.status)return t.data;s=`${null!==(o=t.statusText)&&void 0!==o?o:"unspecified"}`}else s=`Poorly formed response to GET ${e}: ${JSON.stringify(t)}`}catch(i){const t=l(i);s=`Exception on GET ${e}: ${t}`,console.log(s)}throw new Error(s)}))}function c(e,t){var o;return i(this,void 0,void 0,(function*(){const n=u(e,t);let s="";try{const t=yield a()["delete"](n);if(t&&t.status){if(200===t.status)return;s=`${null!==(o=t.statusText)&&void 0!==o?o:"unspecified"}`}else s=`Poorly formed response to DELETE ${e}: ${JSON.stringify(t)}`}catch(i){const t=l(i);s=`Exception on DELETE ${e}: ${t}`,console.log(s)}throw new Error(s)}))}},3399:(e,t,o)=>{o.r(t),o.d(t,{default:()=>oe});var n=o(3673);const a={class:"q-pa-md"};function s(e,t,o,s,i,l){const u=(0,n.up)("BackupRestoreSettings"),r=(0,n.up)("AutomaticContentArchivesSettings");return(0,n.wg)(),(0,n.iD)("div",a,[(0,n.Wm)(u),(0,n.Wm)(r)])}var i=o(2323);const l={class:"q-mt-md"},u=(0,n._)("div",{class:"text-h5 text-center text-weight-bold q-mb-sm"},"Automatic Content Archives",-1),r=(0,n._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Rolling Backup Rules",-1),c=(0,n._)("div",{class:"q-mt-xs text-caption text-grey-5"},"Define how frequently to create automatic content archives.",-1),d={class:"text-h6 text-bold text-white full-width"},m={class:"text-warning"},p=(0,n._)("p",{class:"text-body2"},"WARNING: This cannot be undone.",-1);function g(e,t,o,a,s,g){const f=(0,n.up)("q-separator"),w=(0,n.up)("q-th"),h=(0,n.up)("q-tr"),x=(0,n.up)("q-td"),b=(0,n.up)("q-btn"),v=(0,n.up)("q-input"),y=(0,n.up)("q-icon"),_=(0,n.up)("q-table"),k=(0,n.up)("q-card-section"),D=(0,n.up)("q-card"),W=(0,n.up)("q-avatar"),q=(0,n.up)("q-card-actions"),U=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(D,{class:"my-card"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[u,(0,n.Wm)(f),(0,n.Wm)(D,null,{default:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[r,c,(0,n.Wm)(_,{dark:"",class:"bg-grey-9",rows:e.rows},{header:(0,n.w5)((()=>[(0,n.Wm)(h,{class:"bg-primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{class:"text-left"},{default:(0,n.w5)((()=>[(0,n.Uk)("Name")])),_:1}),(0,n.Wm)(w,{class:"text-left"},{default:(0,n.w5)((()=>[(0,n.Uk)("Backup Interval in Seconds")])),_:1}),(0,n.Wm)(w,{class:"text-left"},{default:(0,n.w5)((()=>[(0,n.Uk)("Max Rolled Backup Versions")])),_:1}),(0,n.Wm)(w,{"auto-width":""})])),_:1})])),body:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.backupRules,((t,o)=>((0,n.wg)(),(0,n.j4)(h,{key:t.Name},{default:(0,n.w5)((()=>[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.Name),1)])),_:2},1024),(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.backupInterval),1)])),_:2},1024),(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.maxBackupVersions),1)])),_:2},1024),(0,n.Wm)(x,{class:"text-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{size:"sm",color:"negative",icon:"delete",class:"q-px-xs",onClick:n=>e.onShowConfirmDeleteDialogue("backupRules",o,t.Name),round:""},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),"bottom-row":(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(v,{modelValue:e.newRowNames.backupRules.Name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newRowNames.backupRules.Name=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"New Backup Rule Name",dense:""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(v,{modelValue:e.newRowNames.backupRules.backupInterval,"onUpdate:modelValue":t[1]||(t[1]=t=>e.newRowNames.backupRules.backupInterval=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Backup Interval (seconds)",dense:""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(v,{modelValue:e.newRowNames.backupRules.maxBackupVersions,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newRowNames.backupRules.maxBackupVersions=t),class:"no-margin no-padding text-subtitle2 text-white",standout:"bg-primary text-white",label:"Maximum Rolled Backup Versions",dense:""},null,8,["modelValue"])])),_:1}),(0,n.Wm)(x,{class:"text-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{onClick:t[3]||(t[3]=t=>e.onAddRow("backupRules")),color:"positive"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{name:"add",size:"sm"})])),_:1})])),_:1})])),_:1})])),_:1},8,["rows"])])),_:1})])),_:1}),(0,n.Wm)(U,{modelValue:e.confirmDeleteDialogue.show,"onUpdate:modelValue":t[6]||(t[6]=t=>e.confirmDeleteDialogue.show=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(D,{class:"bg-primary q-pa-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{class:"row items-center"},{default:(0,n.w5)((()=>[(0,n._)("p",d,[(0,n.Wm)(W,{icon:"mdi-alert",class:"q-mr-sm","text-color":"warning",size:"20px","font-size":"20px"}),(0,n.Uk)("Delete "),(0,n._)("span",m,(0,i.zw)(e.confirmDeleteDialogue.thingToDelete),1),(0,n.Uk)("?")]),p])),_:1}),(0,n.Wm)(q,{align:"center"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{flat:"",label:"Cancel",onClick:t[4]||(t[4]=t=>e.onHideConfirmDeleteDialogue())}),(0,n.Wm)(b,{flat:"",label:"Delete",onClick:t[5]||(t[5]=t=>e.onDeleteRow(e.confirmDeleteDialogue.permissionType,e.confirmDeleteDialogue.index))})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])}var f=o(5593),w=function(e,t,o,n){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(t){s(t)}}function l(e){try{u(n["throw"](e))}catch(t){s(t)}}function u(e){e.done?o(e.value):a(e.value).then(i,l)}u((n=n.apply(e,t||[])).next())}))};const h=(0,n.aZ)({name:"AutomaticContentArchivesSettings",data(){return{rows:[{}],values:{},newRowNames:{backupRules:{Name:"",backupInterval:0,maxBackupVersions:0}},confirmDeleteDialogue:{show:!1,thingToDelete:"",index:-1,permissionType:""}}},methods:{onShowConfirmDeleteDialogue(e,t,o){this.confirmDeleteDialogue={show:!0,thingToDelete:o,index:t,permissionType:e}},onHideConfirmDeleteDialogue(){this.confirmDeleteDialogue={show:!1,thingToDelete:"",index:-1,permissionType:""}},onDeleteRow(e,t){this.onHideConfirmDeleteDialogue();const o=[...this[e]];o.splice(t,1),this[e]=o},onAddRow(e){this[e]=[...this[e],this.newRowNames[e]],this.newRowNames[e]={Name:"",backupInterval:0,maxBackupVersions:0}},refreshSettingsValues(){return w(this,void 0,void 0,(function*(){this.values=yield f.Z.getValues()}))},saveSettings(){const e={automatic_content_archives:{backup_rules:this.backupRules}};f.Z.automaticCommitSettings(e)}},computed:{backupRules:{get(){var e,t;return null!==(t=null===(e=this.values.automatic_content_archives)||void 0===e?void 0:e.backup_rules)&&void 0!==t?t:[]},set(e){var t;"undefined"!==typeof(null===(t=this.values.automatic_content_archives)||void 0===t?void 0:t.backup_rules)&&(this.values.automatic_content_archives.backup_rules=e,this.saveSettings())}}},beforeMount(){this.refreshSettingsValues()}});var x=o(4260),b=o(151),v=o(5589),y=o(5869),_=o(3350),k=o(8186),D=o(2414),W=o(3884),q=o(8240),U=o(4842),S=o(4554),R=o(6778),Z=o(5096),C=o(9367),N=o(7518),V=o.n(N);const T=(0,x.Z)(h,[["render",g]]),Q=T;V()(h,"components",{QCard:b.Z,QCardSection:v.Z,QSeparator:y.Z,QTable:_.Z,QTr:k.Z,QTh:D.Z,QTd:W.Z,QBtn:q.Z,QInput:U.Z,QIcon:S.Z,QDialog:R.Z,QAvatar:Z.Z,QCardActions:C.Z});const I=(0,n._)("p",{class:"q-mb-xs text-body1 text-weight-bold"},"Upload a settings configuration to quickly configure this domain",-1),z=(0,n._)("div",{class:"text-caption text-warning"},"Note: Your domain settings will be replaced by the settings you upload.",-1),B={style:{display:"flex","justify-content":"center","align-items":"center"}},A=(0,n._)("h5",{class:"text-grey-1 text-weight-bolder",style:{position:"absolute","z-index":"1"}},"Upload a Settings Configuration",-1),E={class:"text-grey-1 text-weight-bold",style:{position:"absolute","z-index":"1","margin-top":"5rem"}},$={class:"q-mt-md"},F=(0,n._)("p",{class:"q-mb-none text-body1 text-weight-bold"},"Save Your Settings Configuration",-1),P=(0,n._)("div",{class:"text-caption text-grey-5"},"Download this domain's current settings to quickly configure another domain or to restore them later.",-1),Y=(0,n._)("span",{class:"text-h5 q-mb-sm text-bold text-white"},"Upload Successful!",-1),j={class:"text-body2"},G={class:"text-bold"},O=(0,n._)("span",{class:"text-h5 q-mb-sm text-bold text-white"},"Upload Failed",-1),H=(0,n._)("span",{class:"text-body2"},"Please try again or upload a different settings configuration file.",-1);function M(e,t,o,a,s,l){const u=(0,n.up)("q-icon"),r=(0,n.up)("q-uploader"),c=(0,n.up)("q-btn"),d=(0,n.up)("q-card-section"),m=(0,n.up)("q-card"),p=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.j4)(m,{class:"my-card q-pa-md"},{default:(0,n.w5)((()=>[I,z,(0,n._)("div",B,[(0,n.Wm)(u,{style:{position:"absolute","z-index":"1",color:"#555","font-size":"12rem","margin-top":"2rem"},size:"xl",name:"file_upload"}),A,(0,n._)("p",E,[(0,n.Uk)("Drag and Drop Here or Click "),(0,n.Wm)(u,{name:"add_box",size:"xs",class:"q-mb-xs"}),(0,n.Uk)("to Select a File")]),(0,n.Wm)(r,{label:"Upload a Settings Configuration","max-files":"1",url:"/settings/restore",onUploaded:e.successfulUpload,onFailed:e.failedUpload,style:{height:"500px","min-width":"100%","background-image":"linear-gradient(-45deg, #3d3d3d 25%, #333 25%, #333 50%, #3d3d3d 50%, #3d3d3d 75%, #333 75%, #333 100%)","background-size":"100px 100px",border:"dashed 1px lightgrey"}},null,8,["onUploaded","onFailed"])]),(0,n._)("div",$,[F,P,(0,n.Wm)(c,{color:"positive",href:"/settings/backup.json",target:"_blank",class:"q-mt-sm"},{default:(0,n.w5)((()=>[(0,n.Uk)("Download Domain Settings")])),_:1})]),(0,n.Wm)(p,{modelValue:e.showSuccessfulUploadDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSuccessfulUploadDialog=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"bg-positive q-pa-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"row items-center"},{default:(0,n.w5)((()=>[Y,(0,n._)("span",j,[(0,n.Uk)("Your settings will be commmited and the page will refresh in "),(0,n._)("span",G,(0,i.zw)(e.reloadPageTimer),1),(0,n.Uk)(" seconds")])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(p,{modelValue:e.showFailedUploadDialog,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showFailedUploadDialog=t),"auto-close":""},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{class:"bg-negative q-pa-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"row items-center"},{default:(0,n.w5)((()=>[O,H])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const J=(0,n.aZ)({name:"BackupRestoreSettings",data(){return{uploadedSettingsConfiguration:null,showSuccessfulUploadDialog:!1,reloadPageTimer:3,showFailedUploadDialog:!1}},methods:{successfulUpload(){this.showSuccessfulUploadDialog=!0,window.setInterval((()=>{this.reloadPageTimer--,0===this.reloadPageTimer&&window.location.reload()}),1e3)},failedUpload(){console.log("Failed to upload settings configuration"),this.showFailedUploadDialog=!0}}});var L=o(1745);const K=(0,x.Z)(J,[["render",M]]),X=K;V()(J,"components",{QCard:b.Z,QIcon:S.Z,QUploader:L.Z,QBtn:q.Z,QDialog:R.Z,QCardSection:v.Z});const ee=(0,n.aZ)({name:"Index",components:{AutomaticContentArchivesSettings:Q,BackupRestoreSettings:X}}),te=(0,x.Z)(ee,[["render",s]]),oe=te}}]);